{% extends "base.html" %}

{% block styles %}
    <link rel="stylesheet" href="{{ url_for('static', filename='users.css') }}">
{% endblock %}

{% block main_content %}
    <section id="edit-profile">
        <h2>Edit Profile</h2>
        <form action="{{ url_for('user') }}" method="POST">
            {{ form.hidden_tag() }}
            
            <div class="form-group">
                {{ form.username.label }}<br>
                {{ form.username(size=32, value=session['user_id'], id="username-input") }}<br>
                {% for error in form.username.errors %}
                    <span class="error-message">{{ error }}</span><br>
                {% endfor %}
            </div>

            <div class="form-group">
                {{ form.submit(id="submit-button") }}
            </div>
        </form>
    </section>

    <section id="network">
        <h3>Network</h3>
        <div>
            <h4>Followers</h4>
            <ul>
                {% for follower in followers %}
                    <li>
                        {{ follower.follower }}
                        {% if follower.follower != session["user_id"] %}
                            <a href="{{ url_for('follow_user', username=follower.follower) }}" class="btn">Follow</a>
                            <a href="{{ url_for('unfollow_user', username=follower.follower) }}" class="btn">Unfollow</a>
                        {% endif %}
                    </li>
                {% else %}
                    <li>No followers yet.</li>
                {% endfor %}
            </ul>
        </div>
        <div>
            <h4>Following</h4>
            <ul>
                {% for follow in following %}
                    <li>
                        {{ follow.following }}
                        {% if follow.following != session["user_id"] %}
                            <a href="{{ url_for('follow_user', username=follow.following) }}" class="btn">Follow</a>
                            <a href="{{ url_for('unfollow_user', username=follow.following) }}" class="btn">Unfollow</a>
                        {% endif %}
                    </li>
                {% else %}
                    <li>Not following anyone yet.</li>
                {% endfor %}
            </ul>
        </div>
    </section>

    <section id="user-reviews">
        <h3>Your Reviews</h3>
        {% if reviews %}
            <ul id="reviews-list">
                {% for review in reviews %}
                    <li class="review-item">
                        <strong class="review-movie">Movie:</strong> {{ review.title }}<br>
                        <strong class="review-text">Review:</strong> {{ review.review_text }}<br>
                        <strong class="review-rating">Rating:</strong> {{ review.rating }}/10
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p id="no-reviews-message">You haven't written any reviews yet.</p>
        {% endif %}
    </section>
        <a href="{{ url_for('index') }}" class="back-button">Back to Home</a>

    </section>


{% endblock %}